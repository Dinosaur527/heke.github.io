<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSY帮助论坛</title>
    <!-- 引入Tailwind CSS实现美观样式 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入图标库 -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
        /* 自定义全局样式 */
        body {
            background-color: #f5f7fa;
            font-family: 'Inter', system-ui, sans-serif;
        }
        .card-shadow {
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            transition: box-shadow 0.3s ease;
        }
        .card-shadow:hover {
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        }
        .btn-primary {
            background-color: #2563eb;
            color: white;
            transition: background-color 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .comment-item {
            border-left: 3px solid #94a3b8;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- 顶部导航栏 -->
    <header class="bg-white card-shadow sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-2">
                <<i class="fa fa-comments-o text-2xl text-blue-600"></</i>
                <h1 class="text-xl md:text-2xl font-bold text-gray-800">KSY帮助论坛</h1>
            </div>
            <nav>
                <button class="btn-primary px-4 py-2 rounded-lg flex items-center gap-1">
                    <<i class="fa fa-pencil"></</i> 发布新帖
                </button>
            </nav>
        </div>
    </header>

    <!-- 主体内容 -->
    <main class="container mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- 左侧：发帖区域 -->
        <div class="lg:col-span-1">
            <div class="bg-white rounded-xl p-6 card-shadow">
                <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                    <<i class="fa fa-edit text-blue-500"></</i> 发布帖子
                </h2>
                <form id="postForm" class="space-y-4">
                    <div>
                        <label for="postTitle" class="block text-sm font-medium text-gray-700 mb-1">标题</label>
                        <input type="text" id="postTitle" placeholder="请输入帖子标题（必填）" 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="postContent" class="block text-sm font-medium text-gray-700 mb-1">内容</label>
                        <textarea id="postContent" rows="6" placeholder="请详细描述你的问题或分享经验（必填）" 
                                  class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>
                    <div>
                        <label for="postTag" class="block text-sm font-medium text-gray-700 mb-1">标签</label>
                        <input type="text" id="postTag" placeholder="输入标签，用逗号分隔（可选）" 
                               class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <button type="submit" class="w-full btn-primary py-2 rounded-lg font-medium">
                        发布帖子
                    </button>
                </form>
            </div>
        </div>

        <!-- 右侧：帖子列表 + 评论区域 -->
        <div class="lg:col-span-2">
            <div class="bg-white rounded-xl p-6 card-shadow mb-6">
                <h2 class="text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2">
                    <<i class="fa fa-list-alt text-blue-500"></</i> 最新帖子
                </h2>
                <!-- 帖子列表容器 -->
                <div id="postList" class="space-y-6">
                    <!-- 示例帖子（默认展示1条） -->
                    <div class="border-b border-gray-100 pb-6 last:border-0 last:pb-0">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-xl font-bold text-gray-800">如何解决KSY部署时的跨域问题？</h3>
                            <span class="text-xs text-gray-500">2024-05-20 14:30</span>
                        </div>
                        <div class="text-gray-600 mb-3">
                            我在部署KSY相关项目时，遇到了跨域请求被拦截的问题，尝试了配置CORS但还是没解决，有没有大佬能指导一下？
                        </div>
                        <div class="flex gap-2 mb-4">
                            <span class="px-2 py-1 bg-blue-50 text-blue-600 text-xs rounded-full">部署问题</span>
                            <span class="px-2 py-1 bg-green-50 text-green-600 text-xs rounded-full">跨域</span>
                        </div>
                        <!-- 评论区域 -->
                        <div class="mt-4 space-y-4">
                            <div class="flex gap-3 comment-item pl-3 py-2">
                                <img src="https://picsum.photos/id/1/40/40" alt="用户头像" class="w-10 h-10 rounded-full">
                                <div>
                                    <div class="flex items-center gap-2">
                                        <span class="font-medium text-gray-800">技术助手</span>
                                        <span class="text-xs text-gray-500">2小时前</span>
                                    </div>
                                    <p class="text-gray-600 mt-1">可以尝试在服务器配置中添加Access-Control-Allow-Origin字段，允许请求来源域名，或者使用代理转发的方式规避跨域~</p>
                                </div>
                            </div>
                            <!-- 评论输入框 -->
                            <form class="commentForm flex gap-3" data-post-id="1">
                                <img src="https://picsum.photos/id/20/40/40" alt="当前用户头像" class="w-10 h-10 rounded-full">
                                <div class="flex-1">
                                    <textarea rows="2" placeholder="写下你的评论..." 
                                              class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-500"></textarea>
                                    <button type="submit" class="mt-2 btn-primary px-3 py-1 rounded text-sm">
                                        提交评论
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="text-gray-400">© 2024 KSY帮助论坛 - 所有权利保留</p>
            <p class="text-gray-500 text-sm mt-2">专注于KSY相关问题解答与经验分享</p>
        </div>
    </footer>

    <!-- JavaScript 功能实现 -->
    <script>
        // 帖子数据存储（前端临时存储）
        let posts = [
            // 示例帖子数据
            {
                id: 1,
                title: "如何解决KSY部署时的跨域问题？",
                content: "我在部署KSY相关项目时，遇到了跨域请求被拦截的问题，尝试了配置CORS但还是没解决，有没有大佬能指导一下？",
                tags: ["部署问题", "跨域"],
                time: "2024-05-20 14:30",
                comments: [
                    {
                        username: "技术助手",
                        avatar: "https://picsum.photos/id/1/40/40",
                        content: "可以尝试在服务器配置中添加Access-Control-Allow-Origin字段，允许请求来源域名，或者使用代理转发的方式规避跨域~",
                        time: "2小时前"
                    }
                ]
            }
        ];

        // 渲染帖子列表
        function renderPosts() {
            const postList = document.getElementById("postList");
            postList.innerHTML = "";

            posts.forEach(post => {
                // 生成标签HTML
                const tagHtml = post.tags.map(tag => 
                    `<span class="px-2 py-1 bg-blue-50 text-blue-600 text-xs rounded-full">${tag}</span>`
                ).join("");

                // 生成评论HTML
                const commentHtml = post.comments.map(comment => 
                    `<div class="flex gap-3 comment-item pl-3 py-2">
                        <img src="${comment.avatar}" alt="用户头像" class="w-10 h-10 rounded-full">
                        <div>
                            <div class="flex items-center gap-2">
                                <span class="font-medium text-gray-800">${comment.username}</span>
                                <span class="text-xs text-gray-500">${comment.time}</span>
                            </div>
                            <p class="text-gray-600 mt-1">${comment.content}</p>
                        </div>
                    </div>`
                ).join("");

                // 帖子HTML
                const postHtml = `
                    <div class="border-b border-gray-100 pb-6 last:border-0 last:pb-0">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-xl font-bold text-gray-800">${post.title}</h3>
                            <span class="text-xs text-gray-500">${post.time}</span>
                        </div>
                        <div class="text-gray-600 mb-3">${post.content}</div>
                        <div class="flex gap-2 mb-4">${tagHtml}</div>
                        <!-- 评论区域 -->
                        <div class="mt-4 space-y-4">
                            ${commentHtml}
                            <!-- 评论输入框 -->
                            <form class="commentForm flex gap-3" data-post-id="${post.id}">
                                <img src="https://picsum.photos/id/20/40/40" alt="当前用户头像" class="w-10 h-10 rounded-full">
                                <div class="flex-1">
                                    <textarea rows="2" placeholder="写下你的评论..." 
                                              class="w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-1 focus:ring-blue-500"></textarea>
                                    <button type="submit" class="mt-2 btn-primary px-3 py-1 rounded text-sm">
                                        提交评论
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                `;

                postList.innerHTML += postHtml;
            });

            // 绑定评论表单提交事件
            bindCommentForms();
        }

        // 绑定发帖表单提交事件
        document.getElementById("postForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const title = document.getElementById("postTitle").value.trim();
            const content = document.getElementById("postContent").value.trim();
            const tagInput = document.getElementById("postTag").value.trim();
            const tags = tagInput ? tagInput.split(",").map(tag => tag.trim()) : [];

            // 验证必填项
            if (!title || !content) {
                alert("标题和内容不能为空！");
                return;
            }

            // 生成新帖子
            const newPost = {
                id: posts.length + 1,
                title: title,
                content: content,
                tags: tags,
                time: new Date().toLocaleString("zh-CN", { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' }),
                comments: []
            };

            // 添加到帖子列表并重新渲染
            posts.unshift(newPost); // 新增帖子排在最前面
            renderPosts();

            // 重置表单
            this.reset();
        });

        // 绑定评论表单提交事件
        function bindCommentForms() {
            document.querySelectorAll(".commentForm").forEach(form => {
                form.addEventListener("submit", function(e) {
                    e.preventDefault();
                    const postId = parseInt(this.dataset.postId);
                    const commentContent = this.querySelector("textarea").value.trim();

                    if (!commentContent) {
                        alert("评论内容不能为空！");
                        return;
                    }

                    // 找到对应帖子并添加评论
                    const post = posts.find(p => p.id === postId);
                    if (post) {
                        post.comments.push({
                            username: "当前用户",
                            avatar: "https://picsum.photos/id/20/40/40",
                            content: commentContent,
                            time: "刚刚"
                        });

                        // 重新渲染帖子列表
                        renderPosts();
                    }

                    // 重置评论输入框
                    this.querySelector("textarea").value = "";
                });
            });
        }

        // 初始化渲染
        renderPosts();
    </script>
</body>
</html>
